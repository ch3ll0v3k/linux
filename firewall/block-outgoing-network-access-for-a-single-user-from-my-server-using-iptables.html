<!DOCTYPE html><html
dir="ltr" lang="en-US"><head><meta
charset="UTF-8" /><meta
name="viewport" content="width=device-width, initial-scale=1" /> <script>var cb = function() {
					var l = document.createElement('link'); l.rel = 'stylesheet';
					l.href = '//s0.cyberciti.org/assets/rwd/c/mfeb92016css.css';
					var h = document.getElementsByTagName('head')[0]; h.parentNode.insertBefore(l, h);
				};
		var raf = requestAnimationFrame || mozRequestAnimationFrame ||
			webkitRequestAnimationFrame || msRequestAnimationFrame;
		if (raf) raf(cb);
		else window.addEventListener('load', cb);</script><noscript><link
rel='stylesheet' href='//s0.cyberciti.org/assets/rwd/c/mfeb92016css.css'/></noscript><title>Block Outgoing Network Access For a Single User  Using Iptables</title><link
rel="canonical" href="http://www.cyberciti.biz/tips/block-outgoing-network-access-for-a-single-user-from-my-server-using-iptables.html" /><link
rel="alternate" type="application/rss+xml" title="nixCraft feed" href="http://www.cyberciti.biz/tips/feed" /><link
rel="pingback" href="http://www.cyberciti.biz/tips/xmlrpc.php" /><link
rel='dns-prefetch' href='//s.w.org' /><link
rel="alternate" type="application/rss+xml" title="nixCraft &raquo; Block Outgoing Network Access For a Single User  Using Iptables Comments Feed" href="http://www.cyberciti.biz/tips/block-outgoing-network-access-for-a-single-user-from-my-server-using-iptables.html/feed" /><link
rel='stylesheet' id='ext-widget-opts-css'  href='http://www.cyberciti.biz/tips/wp-content/plugins/widget-options/assets/css/extended-widget-options.css' type='text/css' media='all' /><link
rel='stylesheet' id='wp-syntax-css-css'  href='http://www.cyberciti.biz/tips/wp-content/plugins/wp-syntax/css/wp-syntax.css?ver=1.0' type='text/css' media='all' /> <script type='text/javascript' src='http://www.cyberciti.biz/tips/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script> <script type='text/javascript' src='http://www.cyberciti.biz/tips/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script> <link
rel='https://api.w.org/' href='http://www.cyberciti.biz/tips/wp-json/' /><link
rel="alternate" type="application/json+oembed" href="http://www.cyberciti.biz/tips/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.cyberciti.biz%2Ftips%2Fblock-outgoing-network-access-for-a-single-user-from-my-server-using-iptables.html" /><link
rel="alternate" type="text/xml+oembed" href="http://www.cyberciti.biz/tips/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.cyberciti.biz%2Ftips%2Fblock-outgoing-network-access-for-a-single-user-from-my-server-using-iptables.html&#038;format=xml" /><meta
name="description" content="Explains how to use iptables to block outgoing any user or apache user connection under Linux. " /><link
rel="amphtml" href="http://www.cyberciti.biz/tips/block-outgoing-network-access-for-a-single-user-from-my-server-using-iptables.html/amp" /><link
rel="shortcut icon" href="http://www.cyberciti.biz/tips/wp-content/themes/thesis/lib/images/favicon.ico" /></head><body
class="template-single"> <script type="text/javascript">(function(){
  var bsa = document.createElement('script');
     bsa.type = 'text/javascript';
     bsa.async = true;
     bsa.src = '//s3.buysellads.com/ac/bsa.js';
  (document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(bsa);
})();</script> <div
class="container"> <span
class="menu_control">≡ Menu</span><ul
id="menu-menu-1" class="menu"><li
id="menu-item-113451" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-113451"><a
href="/">Home</a></li><li
id="menu-item-113502" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-113502"><a
href="/faq/">Howtos and Tutorials</a></li><li
id="menu-item-113500" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-113500"><a
href="https://bash.cyberciti.biz/guide/Main_Page">Linux Shell Scripting TutoriaL</a></li><li
id="menu-item-113503" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-113503"><a
href="/tips/about-us">About</a></li><li
id="menu-item-113501" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-113501"><a
href="/nixcraft-rss-feed-syndication/">RSS/Feed</a></li></ul><div
id="header" class="header"><div
id="site_title"><a
href="http://www.cyberciti.biz/tips">nixCraft</a></div><div
id="site_tagline">Linux Tips, Hacks, Tutorials, And Ideas In Blog Format</div></div><div
class="columns"><div
class="content"><div
id="post-900" class="post_box grt top" itemscope itemtype="http://schema.org/Article"><meta
itemscope itemprop="mainEntityOfPage" itemType="https://schema.org/WebPage" itemid="http://www.cyberciti.biz/tips/block-outgoing-network-access-for-a-single-user-from-my-server-using-iptables.html" /><div
class="headline_area"><h1 class="headline" itemprop="headline">Block Outgoing Network Access For a Single User  Using Iptables</h1><div
class="byline small"> <span
class="post_author_intro">by</span> <span
class="post_author">Vivek Gite</span> <span
class="post_date_intro">on</span> <span
class="post_date" title="2006-04-04">April 4, 2006<span
style='font-style: italic; text-transform: lowercase;'> last updated </span>February 7, 2010</span><div
class="post_cats"> <span
class="post_cats_intro">in</span> <a
href="http://www.cyberciti.biz/tips/category/iptables" rel="category tag">Iptables</a></div></div></div><div
class="post_content"><div
style='float:right;margin-top:0px;margin-left:5px;'><a
href='//www.cyberciti.biz/tips/category/iptables' title='See all Firewall related tips/articles'><img
src='//s0.cyberciti.org/images/category/old/firewall.png' border='0' /></a></div><p><span
class="drop_cap">I</span>ptables has a special module called owner (ipt_owner), which is attempts to match various characteristics of the packet creator, for locally generated packets. It is valid in the  OUTPUT and POSTROUTING chains.<br
/> <span
id="more-900"></span><br
/> This is quite useful if you like to block a user within your Linux server to have network access then you can use owner module to match user and block all outgoing traffic for that user. For example, user oracle can connect to oracle database server (using ssh) but not allowed to all outgoing traffic. On other hand user, admin should allow to connect outside network to download updates from RHN or Oracle site. This is nifty module and I use extensively to restrict outgoing access to certain users.<p><center><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>  <ins
class="adsbygoogle"
style="display:inline-block;width:336px;height:280px"
data-ad-client="ca-pub-7825705102693166"
data-ad-slot="2404767461"></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script></p></center></p><h2>Syntax:</h2><pre>iptables -A OUTPUT -o ethX -m owner --uid-owner {USERNAME} -j DROP</pre><p>OR</p><pre>iptables -A OUTPUT -o ethX -m owner --uid-owner {USERNAME} -j REJECT</pre><p>OR</p><pre>iptables -A OUTPUT -o ethX -m owner --uid-owner {USERNAME} -j REJECT</pre><p>OR</p><pre>iptables -A OUTPUT -o ethX -m owner --uid-owner {USERNAME} -j ACCEPT</pre><p>Where,</p><ul><li>&#8211;uid-owner { USERNAME } : Matches if the packet was created by a process with the given effective USERNAME.</li><li>-A : Append rule to given table/chain</li><li>-I : Insert rule to head of table/chain</li></ul><p>For example, my oracle user id is 1000 so I will append following rule:</p><pre>/sbin/iptables -A OUTPUT -o eth0 -m owner --uid-owner 1000 -j DROP
service iptables save</pre><h3>Example: Block Apache User Making Outgoing Connections</h3><div
style='float:right;margin-top:0px;margin-left:5px;'><a
href='//www.cyberciti.biz/tips/category/apache' title='See all Apache Webserver related tips/articles'><img
src='//s0.cyberciti.org/images/category/old/apachelogo.gif' border='0' /></a></div><p>Use the following iptables based configuration to block all outgoing connections made by Apache user. This blocks hackers downloading code into your server using wget or any other tools:</p><div
class="wp_syntax"><table><tr><td
class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">--append</span> OUTPUT <span style="color: #660033;">-m</span> state <span style="color: #660033;">--state</span> ESTABLISHED,RELATED <span style="color: #660033;">-j</span> ACCEPT
&nbsp;
<span style="color: #666666; font-style: italic;"># create a new chain</span>
iptables <span style="color: #660033;">--new-chain</span> chk_apache_user
&nbsp;
<span style="color: #666666; font-style: italic;"># use new chain to process packets generated by apache</span>
iptables <span style="color: #660033;">-A</span> OUTPUT <span style="color: #660033;">-m</span> owner <span style="color: #660033;">--uid-owner</span> apache <span style="color: #660033;">-j</span> chk_apache_user
&nbsp;
<span style="color: #666666; font-style: italic;"># Allow 143 (IMAP) and 25 so that webmail works :)</span>
iptables <span style="color: #660033;">-A</span> chk_apache_user <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">--syn</span> <span style="color: #660033;">-d</span> 127.0.0.1 <span style="color: #660033;">--dport</span> <span style="color: #000000;">143</span> <span style="color: #660033;">-j</span> RETURN
iptables <span style="color: #660033;">-A</span> chk_apache_user <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">--syn</span> <span style="color: #660033;">-d</span> 127.0.0.1 <span style="color: #660033;">--dport</span> <span style="color: #000000;">25</span>  <span style="color: #660033;">-j</span> RETURN
&nbsp;
<span style="color: #666666; font-style: italic;"># reject everything else and stop hackers downloading code into our server</span>
iptables <span style="color: #660033;">-A</span> chk_apache_user <span style="color: #660033;">-j</span> REJECT</pre></td></tr></table></div><p>Add/modify above code to your existing firewall script. This module also support following options:</p><ul><li>&#8211;gid-owner {groupid}: Matches if the packet was created by a process with the given effective group id.</li><li>&#8211;pid-owner {processed}:  Matches if the packet was created by a process with the given process id.</li><li>&#8211;sid-owner {sessionid}:  Matches if the packet was created by a process in the given session group.</li><li>&#8211;cmd-owner {name} : Matches  if the packet was created by a process with the given command name.</li></ul><p>Please note that that some packets (such as ICMP ping responses) may have no owner (or suid based program), and hence never match. Also for some options, you may need to recompile kernel. On Red Hat Enterprise Linux and Debian default kernel has support for owner module.</p> <strong>Share this on:</strong><br/><div
class="nixcraft-social"><a
class="nixcraft-link nixcraft-twitter" href="https://twitter.com/intent/tweet?text=Block+Outgoing+Network+Access+For+a+Single+User++Using+Iptables&url=http://www.cyberciti.biz/tips/block-outgoing-network-access-for-a-single-user-from-my-server-using-iptables.html&via=nixcraft" title="Tweet this tutorial/page">Twitter</a><a
class="nixcraft-link nixcraft-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://www.cyberciti.biz/tips/block-outgoing-network-access-for-a-single-user-from-my-server-using-iptables.html" title="Share this page/tutorial on Fa
cebook">Facebook</a><a
class="nixcraft-link nixcraft-googleplus" href="https://plus.google.com/share?url=http://www.cyberciti.biz/tips/block-outgoing-network-access-for-a-single-user-from-my-server-using-iptables.html" title="Share this page/tutorial on Google+">Google+<a/a><a
class="nixcraft-link nixcraft-pdf" href="http://www.cyberciti.biz/view/pdf/tips/900.php" title="Download this blog post as a free pdf">Download PDF version </a><a
class="nixcraft-link nixcraft-error" href="https://nixcraft.wufoo.com/forms/give-us-feedback-for-nixcraft/def/Field209=http://www.cyberciti.biz/tips/block-outgoing-network-access-for-a-single-user-from-my-server-using-iptables.html&Field211=Block Outgoing Network Access For a Single User  Using Iptables" target="_blank" title="Click here to report Typo/Grammar and other Incorrect information">Found an error/typo on this page?</a></div><div
class="crp_related "><div
class="my_tutorial_series">About the author: Vivek Gite is a seasoned sysadmin and a trainer for the Linux/Unix &amp; shell scripting. Follow him on <strong><a
href="https://twitter.com/nixcraft" style="text-decoration: underline">Twitter</a></strong>. OR <strong>read more like this</strong>:<ul><li><a
href="http://www.cyberciti.biz/tips/linux-iptables-4-block-all-incoming-traffic-but-allow-ssh.html"     class="crp_title">Linux Iptables: Block All Incoming Traffic But Allow SSH</a></li><li><a
href="http://www.cyberciti.biz/tips/linux-iptables-9-allow-icmp-ping.html"     class="crp_title">Linux Iptables allow or block ICMP ping request</a></li><li><a
href="http://www.cyberciti.biz/tips/how-do-i-drop-or-block-attackers-ip-with-null-routes.html"     class="crp_title">How Do I Drop or Block Attackers IP Address With Null Routes On a Linux?</a></li><li><a
href="http://www.cyberciti.biz/tips/linux-iptables-11-how-to-block-or-open-httpweb-service.html"     class="crp_title">Linux Iptables: HowTo Block or Open HTTP/Web Service Port 80 &#038; 443</a></li><li><a
href="http://www.cyberciti.biz/tips/howto-limit-linux-syn-attacks.html"     class="crp_title">Linux Iptables Limit the number of incoming tcp connection / syn-flood&hellip;</a></li><li><a
href="http://www.cyberciti.biz/tips/linux-iptables-6-how-to-block-outgoing-access-to-selectedspecific-ip-address.html"     class="crp_title">Linux Iptables Block Outgoing Access To Selected or Specific IP Address /&hellip;</a></li><li><a
href="http://www.cyberciti.biz/tips/how-do-i-build-a-simple-linux-firewall-for-dsldial-up-connection.html"     class="crp_title">How do I build a Simple Linux Firewall for DSL/Dial-up connection?</a></li><li><a
href="http://www.cyberciti.biz/tips/linux-iptables-2-how-to-block-all-network-traffic.html"     class="crp_title">Linux Iptables block all network traffic</a></li><li><a
href="http://www.cyberciti.biz/tips/iptables-for-restricting-access-by-time-of-day.html"     class="crp_title">Iptables Restricting Access By Time Of The Day</a></li><li><a
href="http://www.cyberciti.biz/tips/linux-iptables-20-allow-oracle-server-incoming-request.html"     class="crp_title">Linux: Iptables # 20 Allow ORACLE server incoming request?</a></li></ul></div><div
class="crp_clear"></div></div></div></div><div
id="comments"><div
class="comments_intro"><span
class="bracket">{</span> <span
class="num_comments">11</span> comments&#8230; <a
href="#commentform" rel="nofollow">add one</a> <span
class="bracket">}</span></div><ul
class="comment_list"><li
class="comment even thread-even depth-1" id="comment-19525"><div
class="comment_head"> <span
class="avatar"></span> <span
class="comment_author">jason</span> <span
class="comment_date">April 4, 2006, 10:16 pm</span></div><div
class="comment_text grt" id="comment-body-19525"><p>Ya very nice and useful. Just a quick note, if you are using RHEL firewall (GNOME Lokkit or system-config-securitylevel command), type following command shell promot:<br
/> <b># iptables -I OUTPUT -o ethX -m owner &#8211;uid-owner oracle -j REJECT</b><br
/> And save firwall:<br
/> <b># /etc/init.d/iptables save</b></p><p>Cheers,</p><p>Jason.</p></div><div
class="comment_footer"> <a
rel='nofollow' class='comment-reply-link' href='http://www.cyberciti.biz/tips/block-outgoing-network-access-for-a-single-user-from-my-server-using-iptables.html?replytocom=19525#commentform' onclick='return addComment.moveForm( "comment-body-19525", "19525", "commentform", "900" )' aria-label='Reply to jason'>Reply</a> <a
class="comment_permalink" href="#comment-19525" title="permalink to this comment" rel="nofollow">Link</a></div></li><li
class="comment odd alt thread-odd thread-alt depth-1" id="comment-142324"><div
class="comment_head"> <span
class="avatar"></span> <span
class="comment_author">Ohmster</span> <span
class="comment_date">January 1, 2008, 11:00 pm</span></div><div
class="comment_text grt" id="comment-body-142324"><p>This is a neat idea, but I use my Linux box as a router and would like to know how to deny and enable internet access for a single user on my network, the Linux box enables access by ip4v forwarding. I want to deny a particular LAN computer such as 192.168.0.2 and then be able to restore it again. Can you show us how to do that please? I really need this one and iptables is very complicated to try and figure out. Thanks.</p></div><div
class="comment_footer"> <a
rel='nofollow' class='comment-reply-link' href='http://www.cyberciti.biz/tips/block-outgoing-network-access-for-a-single-user-from-my-server-using-iptables.html?replytocom=142324#commentform' onclick='return addComment.moveForm( "comment-body-142324", "142324", "commentform", "900" )' aria-label='Reply to Ohmster'>Reply</a> <a
class="comment_permalink" href="#comment-142324" title="permalink to this comment" rel="nofollow">Link</a></div></li><li
class="comment even thread-even depth-1" id="comment-142331"><div
class="comment_head"> <span
class="avatar"></span> <span
class="comment_author">Raj</span> <span
class="comment_date">January 2, 2008, 8:42 am</span></div><div
class="comment_text grt" id="comment-body-142331"><p>Ohmster,</p><p>Use iptables drop target to drop unwanted IP/ You can also use GUI firewall tool such as Firestarter Linux Firewall  or Webbased tool such as webmin.</p></div><div
class="comment_footer"> <a
rel='nofollow' class='comment-reply-link' href='http://www.cyberciti.biz/tips/block-outgoing-network-access-for-a-single-user-from-my-server-using-iptables.html?replytocom=142331#commentform' onclick='return addComment.moveForm( "comment-body-142331", "142331", "commentform", "900" )' aria-label='Reply to Raj'>Reply</a> <a
class="comment_permalink" href="#comment-142331" title="permalink to this comment" rel="nofollow">Link</a></div></li><li
class="comment odd alt thread-odd thread-alt depth-1" id="comment-143933"><div
class="comment_head"> <span
class="avatar"></span> <span
class="comment_author">MT</span> <span
class="comment_date">May 31, 2008, 2:09 pm</span></div><div
class="comment_text grt" id="comment-body-143933"><p>Instead of blocking the IP you can block the mac address of that user&#8217;s machine. Else if you allow a range, he might keep trying to change IPs to get access.</p><p>iptables -A INPUT -m mac &#8211;mac-source xx:xx:xx:xx:xx:xx -j DROP</p><p>Note in windows, you will see mac address as</p><p>Physical Address. . . . . . . . . : xx-xx-xx-xx-xx-xx</p><p>you will have to use : instead of &#8211; , while dropping mac address using iptables</p><p>You can use  ipscan, to find the mac from any windows machine <a
href="http://www.hide-windows.com/Download/ipscan.exe" rel="nofollow">http://www.hide-windows.com/Download/ipscan.exe</a> for your entire lan, just scan the network.</p><p>In linux, you might use ethereal and tcpdump to gather the  mac address of any  other IP, not sure.</p></div><div
class="comment_footer"> <a
rel='nofollow' class='comment-reply-link' href='http://www.cyberciti.biz/tips/block-outgoing-network-access-for-a-single-user-from-my-server-using-iptables.html?replytocom=143933#commentform' onclick='return addComment.moveForm( "comment-body-143933", "143933", "commentform", "900" )' aria-label='Reply to MT'>Reply</a> <a
class="comment_permalink" href="#comment-143933" title="permalink to this comment" rel="nofollow">Link</a></div></li><li
class="comment even thread-even depth-1" id="comment-143934"><div
class="comment_head"> <span
class="avatar"></span> <span
class="comment_author">MT</span> <span
class="comment_date">May 31, 2008, 2:38 pm</span></div><div
class="comment_text grt" id="comment-body-143934"><p>correction:</p><p>its</p><p>iptables -A INPUT -m mac â€“-mac-source xx:xx:xx:xx:xx:xx -j DROP</p></div><div
class="comment_footer"> <a
rel='nofollow' class='comment-reply-link' href='http://www.cyberciti.biz/tips/block-outgoing-network-access-for-a-single-user-from-my-server-using-iptables.html?replytocom=143934#commentform' onclick='return addComment.moveForm( "comment-body-143934", "143934", "commentform", "900" )' aria-label='Reply to MT'>Reply</a> <a
class="comment_permalink" href="#comment-143934" title="permalink to this comment" rel="nofollow">Link</a></div></li><li
class="comment odd alt thread-odd thread-alt depth-1" id="comment-146493"><div
class="comment_head"> <span
class="avatar"></span> <span
class="comment_author">sathyashankar</span> <span
class="comment_date">December 30, 2008, 12:04 pm</span></div><div
class="comment_text grt" id="comment-body-146493"><p>How do I unblock outgoing network access to a user later point in time?<br
/> is there a command that would remove the earlier added rule?</p></div><div
class="comment_footer"> <a
rel='nofollow' class='comment-reply-link' href='http://www.cyberciti.biz/tips/block-outgoing-network-access-for-a-single-user-from-my-server-using-iptables.html?replytocom=146493#commentform' onclick='return addComment.moveForm( "comment-body-146493", "146493", "commentform", "900" )' aria-label='Reply to sathyashankar'>Reply</a> <a
class="comment_permalink" href="#comment-146493" title="permalink to this comment" rel="nofollow">Link</a></div></li><li
class="comment byuser comment-author-administrator bypostauthor even thread-even depth-1" id="comment-146494"><div
class="comment_head"> <span
class="avatar"><a
href="http://www.cyberciti.biz/tips/about-us" rel="nofollow"></a></span> <span
class="comment_author"><a
href='http://www.cyberciti.biz/tips/about-us' rel='external nofollow' class='url'>nixCraft</a></span> <span
class="comment_date">December 30, 2008, 12:27 pm</span></div><div
class="comment_text grt" id="comment-body-146494"><p>Use following syntax to delete rule:</p><pre>iptables  --delete chain rule-specification</pre></div><div
class="comment_footer"> <a
rel='nofollow' class='comment-reply-link' href='http://www.cyberciti.biz/tips/block-outgoing-network-access-for-a-single-user-from-my-server-using-iptables.html?replytocom=146494#commentform' onclick='return addComment.moveForm( "comment-body-146494", "146494", "commentform", "900" )' aria-label='Reply to nixCraft'>Reply</a> <a
class="comment_permalink" href="#comment-146494" title="permalink to this comment" rel="nofollow">Link</a></div></li><li
class="comment odd alt thread-odd thread-alt depth-1" id="comment-151313"><div
class="comment_head"> <span
class="avatar"></span> <span
class="comment_author">David Baron</span> <span
class="comment_date">October 28, 2009, 8:45 pm</span></div><div
class="comment_text grt" id="comment-body-151313"><p>Just what the doctor ordered, but<br
/> ~$ sudo iptables -A OUTPUT -o eth0 -m owner &#8211;uid-owner esti -j DROP<br
/> iptables: No chain/target/match by that name.</p><p>But there is:<br
/> sudo iptables -S | grep OUTPUT<br
/> -P OUTPUT DROP<br
/> -A OUTPUT -o lo -j ACCEPT<br
/> -A OUTPUT -m state &#8211;state RELATED,ESTABLISHED -j ACCEPT<br
/> -A OUTPUT -p icmp -m icmp &#8211;icmp-type 3 -j ACCEPT<br
/> -A OUTPUT -p icmp -m icmp &#8211;icmp-type 11 -j ACCEPT<br
/> -A OUTPUT -p icmp -m icmp &#8211;icmp-type 12 -j ACCEPT<br
/> -A OUTPUT -j s1</p><p>I would probably want the -I option but it needs to recognize the chain!</p><p>Once it is accepted by iptables, where do I do it: rc.local? ifup (where guarddog configures its iptables rules)?</p></div><div
class="comment_footer"> <a
rel='nofollow' class='comment-reply-link' href='http://www.cyberciti.biz/tips/block-outgoing-network-access-for-a-single-user-from-my-server-using-iptables.html?replytocom=151313#commentform' onclick='return addComment.moveForm( "comment-body-151313", "151313", "commentform", "900" )' aria-label='Reply to David Baron'>Reply</a> <a
class="comment_permalink" href="#comment-151313" title="permalink to this comment" rel="nofollow">Link</a></div></li><li
class="comment even thread-even depth-1" id="comment-154001"><div
class="comment_head"> <span
class="avatar"></span> <span
class="comment_author">Alex</span> <span
class="comment_date">February 28, 2010, 9:37 pm</span></div><div
class="comment_text grt" id="comment-body-154001"><p>David Baron, check your kernel<br
/> Networking support -&gt;<br
/> Networking options -&gt;<br
/> Network packet filtering framework (Netfilter) -&gt;<br
/> Core Netfilter Configuration -&gt;<br
/> &#8220;owner&#8221; match support</p></div><div
class="comment_footer"> <a
rel='nofollow' class='comment-reply-link' href='http://www.cyberciti.biz/tips/block-outgoing-network-access-for-a-single-user-from-my-server-using-iptables.html?replytocom=154001#commentform' onclick='return addComment.moveForm( "comment-body-154001", "154001", "commentform", "900" )' aria-label='Reply to Alex'>Reply</a> <a
class="comment_permalink" href="#comment-154001" title="permalink to this comment" rel="nofollow">Link</a></div></li><li
class="comment odd alt thread-odd thread-alt depth-1" id="comment-354186"><div
class="comment_head"> <span
class="avatar"></span> <span
class="comment_author">Anthony</span> <span
class="comment_date">October 1, 2014, 7:50 pm</span></div><div
class="comment_text grt" id="comment-body-354186"><p>Hi,</p><p> Great Write up. Is there a way to do the reverse of this?</p><p>I would like to filter incoming traffic by user UID instead of filtering via IP and then make sure its applied only to eth0 and port 22.</p></div><div
class="comment_footer"> <a
rel='nofollow' class='comment-reply-link' href='http://www.cyberciti.biz/tips/block-outgoing-network-access-for-a-single-user-from-my-server-using-iptables.html?replytocom=354186#commentform' onclick='return addComment.moveForm( "comment-body-354186", "354186", "commentform", "900" )' aria-label='Reply to Anthony'>Reply</a> <a
class="comment_permalink" href="#comment-354186" title="permalink to this comment" rel="nofollow">Link</a></div></li><li
class="comment even thread-even depth-1" id="comment-405948"><div
class="comment_head"> <span
class="avatar"></span> <span
class="comment_author">markpat</span> <span
class="comment_date">November 9, 2014, 5:22 pm</span></div><div
class="comment_text grt" id="comment-body-405948"><p>Any way to enable &#8211;pid-owner or &#8211;cmd-owner on centos 6.6? Only have &#8211;uid-owner and &#8211;gid-owner enabled, but i need to filter by pid.</p></div><div
class="comment_footer"> <a
rel='nofollow' class='comment-reply-link' href='http://www.cyberciti.biz/tips/block-outgoing-network-access-for-a-single-user-from-my-server-using-iptables.html?replytocom=405948#commentform' onclick='return addComment.moveForm( "comment-body-405948", "405948", "commentform", "900" )' aria-label='Reply to markpat'>Reply</a> <a
class="comment_permalink" href="#comment-405948" title="permalink to this comment" rel="nofollow">Link</a></div></li></ul><div
id="commentform"><form
method="post" action="http://www.cyberciti.biz/tips/wp-comments-post.php"> <strong>Security: Are you a robot or human?</strong><div
id="g-recaptcha-0" class="g-recaptcha" data-sitekey="6LdYTuoSAAAAANsHhf0qcTmeH72NPDRJjRJTWpxd" data-theme="light"></div><noscript>Please enable JavaScript to submit this form.<br></noscript><a
rel="nofollow" id="cancel-comment-reply-link" href="/tips/block-outgoing-network-access-for-a-single-user-from-my-server-using-iptables.html#respond" style="display:none;">Cancel reply</a><p
class="comment_form_title">Leave a Comment</p><p
id="comment_form_name"> <label
for="author">Name</label> <input
type="text" id="author" class="input_text" name="author" value="" tabindex="1" /></p><p
id="comment_form_email"> <label
for="email">Email</label> <input
type="text" id="email" class="input_text" name="email" value="" tabindex="2" /></p><p
id="comment_form_comment"> <label
for="comment">Comment</label><textarea name="comment" id="comment" class="input_text" tabindex="4" rows="6"></textarea></p><p
id="comment_form_submit"> <input
type="submit" id="submit" class="input_submit" name="submit" tabindex="5" value="Submit" /></p><p
style="display: none;"><input
type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="37f46a4704" /></p><div
class="comment-sub-ops" data-auto="position"> <label
for="comment-mail-sub-type" class="cso-sub-type"> <span
class="cso-icon"><svg
style="width:1em; height:1em; vertical-align:middle;" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg"> <g
fill="currentColor" fill-rule="evenodd"> <path
d="M14.1,5.63571636 C14.9517714,6.33967604 15.450459,7.19287046 15.450459,8.11238878 C15.450459,9.00675525 14.9786798,9.83837654 14.1691007,10.5309611 L15.9373937,14.0087185 L12.3204301,12.0078104 C11.9296094,13.5858368 9.54844584,14.7997638 6.66936474,14.7997638 C5.53232152,14.7997638 4.47293941,14.6104254 3.58314938,14.2840966 L3.58314938,14.2840966 L0.600000024,15.934378 L1.91489821,13.3483263 C1.31289726,12.8333222 0.962083376,12.2149306 0.962083376,11.549882 C0.962083376,11.165606 1.07921023,10.7969075 1.29424428,10.4547307 L1.29424428,10.4547307 C0.538036753,9.77771086 0.100000001,8.97417858 0.100000001,8.11238878 C0.100000001,7.04123575 0.776722924,6.06008476 1.89999998,5.30000019 L1.89999998,7.0658888 C1.89999998,7.30870143 2.09163284,7.50553995 2.34867325,7.50553995 L13.6513267,7.50553995 C13.8991221,7.50553995 14.1,7.31362877 14.1,7.0658888 L14.1,5.63571636 L14.1,5.63571636 Z M1.91455086,10.9345943 C1.80464172,11.1556337 1.74596704,11.3882813 1.74596704,11.6284523 C1.74596704,12.1628789 2.03649339,12.660053 2.53556999,13.0749705 L1.89355472,14.5590821 L3.60073421,13.7061116 L3.60073421,13.7061116 C4.4110062,14.0513606 5.42865146,14.2569046 6.53374306,14.2569046 C8.94591699,14.2569046 10.9414496,13.2775827 11.2731076,12.0036603 C10.2241563,12.3100096 9.03514487,12.482874 7.77522952,12.482874 C5.42553187,12.482874 3.3224447,11.8816356 1.91455086,10.9345943 L1.91455086,10.9345943 Z M3.03674893,0 C2.79553911,0 2.5999999,0.198275445 2.5999999,0.450938832 L2.5999999,6.42178844 C2.5999999,6.67083508 2.80610042,6.87272727 3.03674893,6.87272727 L12.9632509,6.87272727 C13.2044607,6.87272727 13.3999999,6.67445183 13.3999999,6.42178844 L13.3999999,0.450938832 C13.3999999,0.201892192 13.1938994,0 12.9632509,0 L3.03674893,0 Z M7.99999989,4.5999999 L12.5,0.600000013 L11.5625,0.600000013 L7.99999989,2.78181813 L4.43749976,0.600000013 L3.5,0.599999905 L7.99999989,4.5999999 Z"></path> </g> </svg></span> Receive Email Notifications? </label> <select
id="comment-mail-sub-type" name="comment_mail_sub_type" class="cso-sub-type form-control" title="Receive Notifications?"><option
value="">no, do not subscribe</option><option
value="comment" selected='selected'>yes, replies to my comment</option><option
value="comments">yes, all comments/replies</option> </select> <select
id="comment-mail-sub-deliver" name="comment_mail_sub_deliver" class="cso-sub-deliver form-control" title="Notify Me"><option
value="asap" selected='selected'>instantly</option><option
value="hourly">hourly digest</option><option
value="daily">daily digest</option><option
value="weekly">weekly digest</option> </select><div
class="cso-links"> <span
class="cso-link-new">Or, you can <a
href="http://www.cyberciti.biz/tips/?comment_mail%5Bmanage%5D%5Bsub_new%5D=0&amp;comment_mail%5Bmanage%5D%5Bsub_form%5D%5Bpost_id%5D=900" rel="nofollow">subscribe without commenting</a>.</span></div></div><style type="text/css">.comment-sub-ops
        {
            margin : 1em 0 1em 0;
        }
        .comment-sub-ops label
        {
            display : block;
        }
        .comment-sub-ops select
        {
            box-sizing : border-box;
            display    : inline-block;
        }
        .comment-sub-ops select.cso-sub-type
        {
            width : 70%;
            float : left;
        }
        .comment-sub-ops select.cso-sub-deliver
        {
            width : 28%;
            float : right;
        }
        .comment-sub-ops select.cso-sub-deliver[disabled]
        {
            opacity : 0.3;
        }
        .comment-sub-ops .cso-links
        {
            font-size   : 80%;
            line-height : 1.5em;
            margin      : 0 0 0 .5em;
            clear       : both;
        }
        .comment-sub-ops .cso-links .cso-link-summary
        {
            display     : block;
            line-height : 1em;
        }</style><p
style="display: none;"><input
type="hidden" id="ak_js" name="ak_js" value="190"/></p><input
type='hidden' name='comment_post_ID' value='900' id='comment_post_ID' /> <input
type='hidden' name='comment_parent' id='comment_parent' value='0' /></form></div> <br/><div
style="font-size: 85%;">&nbsp;&nbsp; Tagged with: <a
href="http://www.cyberciti.biz/tips/tag/apache" rel="tag">Apache</a>, <a
href="http://www.cyberciti.biz/tips/tag/chains" rel="tag">chains</a>, <a
href="http://www.cyberciti.biz/tips/tag/firewall-script" rel="tag">firewall script</a>, <a
href="http://www.cyberciti.biz/tips/tag/hackers" rel="tag">hackers</a>, <a
href="http://www.cyberciti.biz/tips/tag/imap" rel="tag">imap</a>, <a
href="http://www.cyberciti.biz/tips/tag/iptables-apache-user-block-outgoing-connections" rel="tag">iptables apache user block outgoing connections</a>, <a
href="http://www.cyberciti.biz/tips/tag/iptables-owner-matching" rel="tag">iptables owner matching</a>, <a
href="http://www.cyberciti.biz/tips/tag/ipt_owner" rel="tag">ipt_owner</a>, <a
href="http://www.cyberciti.biz/tips/tag/linux" rel="tag">Linux</a>, <a
href="http://www.cyberciti.biz/tips/tag/linux-server" rel="tag">linux server</a>, <a
href="http://www.cyberciti.biz/tips/tag/oracle" rel="tag">oracle</a>, <a
href="http://www.cyberciti.biz/tips/tag/oracle-database-server" rel="tag">oracle database server</a>, <a
href="http://www.cyberciti.biz/tips/tag/oracle-user" rel="tag">oracle user</a>, <a
href="http://www.cyberciti.biz/tips/tag/outgoing-connections" rel="tag">outgoing connections</a>, <a
href="http://www.cyberciti.biz/tips/tag/outgoing-traffic" rel="tag">outgoing traffic</a>, <a
href="http://www.cyberciti.biz/tips/tag/rhn" rel="tag">rhn</a></div></div><div
class="prev_next"><p
class="next_post">Next post: <a
href="http://www.cyberciti.biz/tips/freebsd-download-sun-java-jdk-and-jre-15-binaries.html" rel="next">FreeBSD Download Sun Java JDK and JRE 1.5 Binaries</a></p><p
class="previous_post">Previous post: <a
href="http://www.cyberciti.biz/tips/can-i-use-ssl-certificate-for-my-sub-domains-as-well.html" rel="prev">Can I use SSL certificate for my sub domains as well?</a></p></div></div><div
class="sidebar"><div
class="extendedwopts-show extendedwopts-desktop widget widget_text" id=""><div
class="textwidget"><div
id="bsap_1304534" class="bsarocks bsap_bccb43591680e039e32e874cbcc9e431"></div></div></div><div
class="widget search-form" id="thesis-search-widget-5"><form
class="search_form" method="get" action="http://www.cyberciti.biz/tips"><p> <input
class="input_text" type="text" id="s" name="s" value="To search, type and hit enter" onfocus="if (this.value == 'To search, type and hit enter') {this.value = '';}" onblur="if (this.value == '') {this.value = 'To search, type and hit enter';}" /> <input
type="hidden" id="searchsubmit" value="Search" /></p></form></div><div
class="extendedwopts-show extendedwopts-desktop widget widget_text" id=""><div
class="textwidget"><center> <ins
class="adsbygoogle"
style="display:inline-block;width:300px;height:600px;"
data-ad-client="ca-pub-7825705102693166"
data-ad-slot="3521177162"></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script> </cener></div></div><div
class="extendedwopts-show extendedwopts-desktop widget widget_text" id=""><p
class="widget_title">Featured Articles:</p><div
class="textwidget"><ul><li><a
href="http://www.cyberciti.biz/open-source/30-cool-best-open-source-softwares-of-2013/">30 Cool Open Source Software I Discovered in 2013</a></li><li><a
href="http://www.cyberciti.biz/tips/bash-aliases-mac-centos-linux-unix.html">30 Handy Bash Shell Aliases For Linux / Unix / Mac OS X</a></li><li><a
href="http://www.cyberciti.biz/networking/nmap-command-examples-tutorials/">Top 30 Nmap Command Examples For Sys/Network Admins</a></li><li><a
href="http://www.cyberciti.biz/tips/php-security-best-practices-tutorial.html">25 PHP Security Best Practices For Sys Admins</a></li><li><a
href="http://www.cyberciti.biz/tips/top-linux-monitoring-tools.html">20 Linux System Monitoring Tools Every SysAdmin Should Know</a></li><li><a
href="http://www.cyberciti.biz/tips/linux-security.html">20 Linux Server Hardening Security Tips</a></li><li><a
href="http://www.cyberciti.biz/tips/linux-iptables-examples.html">Linux: 20 Iptables Examples For New SysAdmins</a></li><li><a
href="http://www.cyberciti.biz/tips/linux-unix-bsd-openssh-server-best-practices.html">Top 20 OpenSSH Server Best Security Practices </a></li><li><a
href="http://www.cyberciti.biz/tips/linux-unix-bsd-nginx-webserver-security.html">Top 20 Nginx WebServer Best Security Practices</a><li><A
href="http://www.cyberciti.biz/tips/check-unix-linux-configuration-file-for-syntax-errors.html">20 Examples: Make Sure Unix / Linux Configuration Files Are Free From Syntax Errors</a><li><a
href="http://www.cyberciti.biz/open-source/best-terminal-applications-for-linux-unix-macosx/">15 Greatest Open Source Terminal Applications Of 2012</a></li><li><a
href="http://www.cyberciti.biz/tips/my-10-unix-command-line-mistakes.html">My 10 UNIX Command Line Mistakes</a></li><li><a
href="http://www.cyberciti.biz/tips/open-source-project-management-software.html">Top 10 Open Source Web-Based Project Management Software</a></li><li><a
href="http://www.cyberciti.biz/tips/download-email-client-for-linux-mac-osx-windows.html">Top 5 Email Client For Linux, Mac OS X, and Windows Users</a></li><li><a
href="http://www.cyberciti.biz/tips/linux-laptop.html">The Novice Guide To Buying A Linux Laptop</a></li></ul></div></div><div
class="extendedwopts-show extendedwopts-desktop widget widget_text" id=""><div
class="textwidget"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>  <ins
class="adsbygoogle"
style="display:inline-block;width:300px;height:1057px"
data-ad-client="ca-pub-7825705102693166"
data-ad-slot="6636490668"></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div><div
class="extendedwopts-show extendedwopts-desktop widget widget_text" id=""><p
class="widget_title">Don&#8217;t Miss Any Linux Tips</p><div
class="textwidget"><form
style="border:1px solid #ccc;padding:3px;text-align:center;" action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open('https://feedburner.google.com/fb/a/mailverify?uri=Nixcraft-LinuxFreebsdSolarisTipsTricks', 'popupwindow', 'scrollbars=yes,width=550,height=520');return true"><p>Get nixCraft in your inbox. It's free:</p><p><input
onfocus="if(this.value=='Your email address') this.value='';" value="Your email address" type="text" style="width:140px" name="email"/></p><input
type="hidden" value="Nixcraft-LinuxFreebsdSolarisTipsTricks" name="uri"/><input
type="hidden" name="loc" value="en_US"/><input
type="submit" value="Subscribe" /></form></div></div><div
class="extendedwopts-show extendedwopts-desktop widget widget_text" id=""><div
class="textwidget"><center> <ins
class="adsbygoogle"
style="display:inline-block;width:300px;height:250px"
data-ad-client="ca-pub-7825705102693166"
data-ad-slot="2272802261"></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script> </center></div></div></div></div><div
class="footer"> &copy;2000-2016 nixCraft. All rights reserved. <a
href="/tips/privacy">Privacy</a> - <a
href="/tips/disclaimer">Terms of Service</a> - <a
href="/tips/contact-us">Questions or Comments</a></div></div><div
data-theiaStickySidebar-sidebarSelector='"#secondary, #sidebar, .sidebar, #primary"'
data-theiaStickySidebar-options='{"containerSelector":"","additionalMarginTop":0,"additionalMarginBottom":0,"updateSidebarHeight":false,"minWidth":0,"sidebarBehavior":"stick-to-bottom","disableOnResponsiveLayouts":true}'></div>
<!-- BEGIN recaptcha, injected by plugin wp-recaptcha-integration  -->
<script type="text/javascript">
				function get_form_submits(el){
					var form,current=el,ui,type,slice = Array.prototype.slice,self=this;
					this.submits=[];
					this.form=false;

					this.setEnabled=function(e){
						for ( var s=0;s<self.submits.length;s++ ) {
							if (e) self.submits[s].removeAttribute('disabled');
							else  self.submits[s].setAttribute('disabled','disabled');
						}
						return this;
					};
					while ( current && current.nodeName != 'BODY' && current.nodeName != 'FORM' ) {
						current = current.parentNode;
					}
					if ( !current || current.nodeName != 'FORM' )
						return false;
					this.form=current;
					ui=slice.call(this.form.getElementsByTagName('input')).concat(slice.call(this.form.getElementsByTagName('button')));
					for (var i = 0; i < ui.length; i++) if ( (type=ui[i].getAttribute('TYPE')) && type=='submit' ) this.submits.push(ui[i]);
					return this;
				}
				</script><script type="text/javascript">
		var recaptcha_widgets={};
		function wp_recaptchaLoadCallback(){ 
			try {
				grecaptcha;
			} catch(err){
				return;
			}
			var e = document.querySelectorAll ? document.querySelectorAll('.g-recaptcha:not(.wpcf7-form-control)') : document.getElementsByClassName('g-recaptcha'),
				form_submits;

			for (var i=0;i<e.length;i++) {
				(function(el){
					var form_submits = get_form_submits(el).setEnabled(false), wid;
					// check if captcha element is unrendered
					if ( ! el.childNodes.length) {
						wid = grecaptcha.render(el,{
							'sitekey':'6LdYTuoSAAAAANsHhf0qcTmeH72NPDRJjRJTWpxd',
							'theme':el.getAttribute('data-theme') || 'light'
							,
							'callback' : function(r){ get_form_submits(el).setEnabled(true); /* enable submit buttons */ }
						});
						el.setAttribute('data-widget-id',wid);
					} else {
						wid = el.getAttribute('data-widget-id');
						grecaptcha.reset(wid);
					}
				})(e[i]);
			}
		}
		
		// if jquery present re-render jquery/ajax loaded captcha elements 
		if ( typeof jQuery !== 'undefined' )
			jQuery(document).ajaxComplete( function(evt,xhr,set){
				if( xhr.responseText && xhr.responseText.indexOf('6LdYTuoSAAAAANsHhf0qcTmeH72NPDRJjRJTWpxd') !== -1)
					wp_recaptchaLoadCallback();
			} );
		
		</script><script src="https://www.google.com/recaptcha/api.js?onload=wp_recaptchaLoadCallback&#038;render=explicit" async defer></script>
<!-- END recaptcha -->
<script type='text/javascript' src='http://www.cyberciti.biz/tips/wp-content/plugins/akismet/_inc/form.js?ver=3.2'></script>
<script type='text/javascript' src='http://www.cyberciti.biz/tips/wp-includes/js/comment-reply.min.js?ver=4.6.1'></script>
<script type='text/javascript' src='http://www.cyberciti.biz/tips/wp-content/plugins/sidebar/js/theia-sticky-sidebar.js?ver=1.6.3'></script>
<script type='text/javascript' src='http://www.cyberciti.biz/tips/wp-content/plugins/sidebar/js/main.js?ver=1.6.3'></script>
<script type='text/javascript' src='http://www.cyberciti.biz/tips/wp-includes/js/wp-embed.min.js?ver=4.6.1'></script>
<script type="text/javascript">
    (function($) // Comment Mail™ subscr. options.
    {
        'use strict'; // Strict standards.

        $(document).ready(
            function() // On DOM ready handler.
            {
                var $subOps = $('.comment-sub-ops'),
                    $subType, $subDeliver; // Initialize vars.

                if($subOps.data('auto') === 'position') $subOps.prevUntil('form')
                    .each(function(/* Auto-position subscription options. */)
                          {
                              var $this = $(this); // Cache this.
                              if($this.find(':input[type="submit"]').length)
                              {
                                  $subOps.remove(), $this.before($subOps);
                                  return false; // Break the each() loop.
                              }
                          });
                $subOps = $('.comment-sub-ops'),
                    $subType = $subOps.find('select.cso-sub-type'),
                    $subDeliver = $subOps.find('select.cso-sub-deliver');

                $subType.on('change', function()
                {
                    if($(this).val() === '')
                        $subDeliver.attr('disabled', 'disabled');
                    else $subDeliver.removeAttr('disabled');
                })
                    .trigger('change');
            });
    })(jQuery);
</script><script type="text/javascript">
    (function($) // Comment Mail™ subscr. options.
    {
        'use strict'; // Strict standards.

        $(document).ready(
            function() // On DOM ready handler.
            {
                var $subOps = $('.comment-sub-ops'),
                    $subType, $subDeliver; // Initialize vars.

                if($subOps.data('auto') === 'position') $subOps.prevUntil('form')
                    .each(function(/* Auto-position subscription options. */)
                          {
                              var $this = $(this); // Cache this.
                              if($this.find(':input[type="submit"]').length)
                              {
                                  $subOps.remove(), $this.before($subOps);
                                  return false; // Break the each() loop.
                              }
                          });
                $subOps = $('.comment-sub-ops'),
                    $subType = $subOps.find('select.cso-sub-type'),
                    $subDeliver = $subOps.find('select.cso-sub-deliver');

                $subType.on('change', function()
                {
                    if($(this).val() === '')
                        $subDeliver.attr('disabled', 'disabled');
                    else $subDeliver.removeAttr('disabled');
                })
                    .trigger('change');
            });
    })(jQuery);
</script><script type="text/javascript">(function(d,g){d[g]||(d[g]=function(g){return this.querySelectorAll("."+g)},Element.prototype[g]=d[g])})(document,"getElementsByClassName");(function(){var classes = document.getElementsByClassName('menu_control');for (i = 0; i < classes.length; i++) {classes[i].onclick = function() {var menu = this.nextElementSibling;if (/show_menu/.test(menu.className))menu.className = menu.className.replace('show_menu', '').trim();else menu.className += ' show_menu';if (/menu_control_triggered/.test(this.className))this.className = this.className.replace('menu_control_triggered', '').trim();else this.className += ' menu_control_triggered';};}})();</script>
<noscript><style type="text/css" scoped>.menu { display: block; }</style></noscript>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-108650-1']);
  _gaq.push(['_setDomainName', 'www.cyberciti.biz']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</body>
</html>